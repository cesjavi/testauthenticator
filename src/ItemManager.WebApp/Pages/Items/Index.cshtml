@page
@model ItemManager.WebApp.Pages.Items.IndexModel
@{
    ViewData["Title"] = "Items";
}
<section class="card">
    <header class="card__header card__header--with-actions">
        <div>
            <h1>Listado de items</h1>
            <p>Gestioná los elementos disponibles en el catálogo protegido.</p>
        </div>
        <form method="post" asp-page-handler="Refresh">
            <button type="submit" class="button button--secondary">Actualizar</button>
        </form>
    </header>
    @if (!string.IsNullOrEmpty(Model.ErrorMessage))
    {
        <div class="alert alert--error">@Model.ErrorMessage</div>
    }
    @if (!string.IsNullOrEmpty(Model.StatusMessage))
    {
        <div class="alert alert--success">@Model.StatusMessage</div>
    }
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Descripción</th>
                    <th>Cantidad</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
            @if (Model.Items.Count == 0)
            {
                <tr>
                    <td colspan="5" class="table__empty">No hay items cargados.</td>
                </tr>
            }
            else
            {
                foreach (var item in Model.Items)
                {
                    <tr>
                        <td>@item.Id</td>
                        <td>@item.Name</td>
                        <td>@(string.IsNullOrWhiteSpace(item.Description) ? "-" : item.Description)</td>
                        <td>@item.Quantity</td>
                        <td class="table__actions">
                            <form method="post" asp-page-handler="Delete" asp-route-id="@item.Id" class="inline-form">
                                <button type="submit" class="button button--link" onclick="return confirm('¿Eliminar el item @item.Name?');">Eliminar</button>
                            </form>
                        </td>
                    </tr>
                }
            }
            </tbody>
        </table>
    </div>
</section>
<section class="card">
    <header class="card__header">
        <h2>Crear nuevo item</h2>
    </header>
    <form method="post" asp-page-handler="Create" class="form form--horizontal">
        <div class="form__group">
            <label asp-for="NewItem.Name"></label>
            <input asp-for="NewItem.Name" class="form__control" />
            <span asp-validation-for="NewItem.Name" class="form__error"></span>
        </div>
        <div class="form__group">
            <label asp-for="NewItem.Description"></label>
            <textarea asp-for="NewItem.Description" class="form__control"></textarea>
            <span asp-validation-for="NewItem.Description" class="form__error"></span>
        </div>
        <div class="form__group">
            <label asp-for="NewItem.Quantity"></label>
            <input asp-for="NewItem.Quantity" class="form__control" type="number" min="0" />
            <span asp-validation-for="NewItem.Quantity" class="form__error"></span>
        </div>
        <button type="submit" class="button button--primary">Crear item</button>
    </form>
</section>
@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
